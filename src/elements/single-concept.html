<link rel="import" href="../vendor/core-tooltip/core-tooltip.html">

<polymer-element name="single-concept" attributes="concept chosenConcept">
  <template>
    <style>
      :host {
        display: inline-block;
        width: 10%;
        margin: 2% 3%;
      }

      img {
        width: 100%;
        border-radius: 50%;
        float:left;
      }

      .imgConceptChosen {
        -webkit-box-shadow: inset 0px 0px 0px 3px rgba(0,0,0,1);
        -moz-box-shadow: inset 0px 0px 0px 3px rgba(0,0,0,1);
        box-shadow: inset 0px 0px 0px 3px rgba(0,0,0,1);
      }

      img:hover { 
        -webkit-box-shadow: inset 0px 0px 0px 3px rgba(0,0,0,1);
        -moz-box-shadow: inset 0px 0px 0px 3px rgba(0,0,0,1);
        box-shadow: inset 0px 0px 0px 3px rgba(0,0,0,1);
      }

      core-tooltip {
        text-transform: capitalize;
        outline: none;
      }

    </style>
    
    <core-tooltip label="{{ concept.name }}"  position="bottom middle">
      <img id="highlight" on-click="{{ setConcept }}" src="{{concept.src}}">
    </core-tooltip>

  </template>

  <script>
    Polymer('single-concept', {
      chosenConcept: [],
      highlight: false,
      ready: function() {

        var self = this;

        function setConcept(){

          // Fool push to work  
          var selfChosenConcept = self.chosenConcept;
          var notOneOfChosenConcepts = 0;
          var totalConcepts = 0;

          // Pushing and and no more than 3

          if (self.chosenConcept.length == 0) {
            selfChosenConcept.push(self.concept.name);
          }

          for (var i = 0; i < self.chosenConcept.length; i++) {
            
            if (self.concept.name == self.chosenConcept[i]) {
              // do nothing
            } else {
              notOneOfChosenConcepts++;
            } 
          }  

          var totalConcepts = self.chosenConcept.length;

          if (notOneOfChosenConcepts == totalConcepts) {  
            if (self.chosenConcept.length > 2) {
                selfChosenConcept.splice(0,1);
                selfChosenConcept.push(self.concept.name);
            } else {
            selfChosenConcept.push(self.concept.name);
            }
          }

          // console.log(self.chosenConcept);

        };

        elem = this.shadowRoot.getElementById('highlight');
        elem.addEventListener('click', setConcept, false);

      },
      chosenConceptChanged: function() {
        var notOneOfChosenConcepts = 0;
        
        for (var i = 0; i < this.chosenConcept.length; i++) {
          if (this.concept.name == this.chosenConcept[i]) {
             this.shadowRoot.getElementById('highlight').classList.add('imgConceptChosen');
          } else { 
            notOneOfChosenConcepts++;
          }  
        }

        if (notOneOfChosenConcepts == 3) {
          this.shadowRoot.getElementById('highlight').classList.remove('imgConceptChosen');
        } 
      }
    });
  </script>
</polymer-element>